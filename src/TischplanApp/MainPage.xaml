<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:controls="clr-namespace:SharedControlsModule.PlatformControls"
             xmlns:selectors="clr-namespace:TischplanApp.Selectors"
             x:Class="TischplanApp.MainPage">

    <ContentPage.Resources>
        <ResourceDictionary>
            <!-- Table Template -->
            <DataTemplate x:Key="TableTemplate">
                <Border Stroke="DarkBlue"
                        StrokeThickness="2"
                        BackgroundColor="LightBlue"
                        StrokeShape="RoundRectangle 8">
                    <Label Text="{Binding Name}"
                           HorizontalOptions="Center"
                           VerticalOptions="Center"
                           FontSize="14"
                           FontAttributes="Bold"
                           TextColor="DarkBlue"/>
                </Border>
            </DataTemplate>

            <!-- Box Template -->
            <DataTemplate x:Key="BoxTemplate">
                <Border Stroke="DarkGreen"
                        StrokeThickness="2"
                        BackgroundColor="LightGreen"
                        StrokeShape="RoundRectangle 4">
                    <VerticalStackLayout HorizontalOptions="Center"
                                        VerticalOptions="Center"
                                        Spacing="4">
                        <Label Text="{Binding Name}"
                               FontSize="12"
                               FontAttributes="Bold"
                               TextColor="DarkGreen"
                               HorizontalOptions="Center"/>
                        <Label Text="{Binding Content}"
                               FontSize="10"
                               TextColor="DarkGreen"
                               HorizontalOptions="Center"/>
                    </VerticalStackLayout>
                </Border>
            </DataTemplate>

            <!-- Template Selector -->
            <selectors:PositionableItemTemplateSelector x:Key="ItemTemplateSelector"
                                                        TableTemplate="{StaticResource TableTemplate}"
                                                        BoxTemplate="{StaticResource BoxTemplate}"/>
        </ResourceDictionary>
    </ContentPage.Resources>

    <!-- Main Layout with Edit Mode Button -->
    <Grid RowDefinitions="Auto,*">
        <!-- Buttons -->
        <HorizontalStackLayout Grid.Row="0" Margin="10" Spacing="10">
            <!-- Edit Mode Toggle Button -->
            <Button Text="{Binding EditModeText}"
                    Clicked="OnEditModeClicked"
                    BackgroundColor="#2196F3"
                    TextColor="White"
                    Padding="20,10"/>

            <!-- Grid Toggle Button -->
            <Button Text="{Binding GridModeText}"
                    Clicked="OnGridModeClicked"
                    BackgroundColor="#4CAF50"
                    TextColor="White"
                    Padding="20,10"/>
        </HorizontalStackLayout>

        <!-- Tischplan mit ItemTemplateSelector IsEditMode="{Binding IsEditMode}"-->
        <controls:ZoomPanCanvas Grid.Row="1"
                               x:Name="ZoomPanCanvas"
                               Tables="{Binding Items}"
                               IsEditMode="{Binding IsEditMode}"
                               ShowGrid="{Binding ShowGrid}"
                               ItemTappedCommand="{Binding ItemTappedCommand}"
                               ItemTemplateSelector="{StaticResource ItemTemplateSelector}"/>
    </Grid>

</ContentPage>
